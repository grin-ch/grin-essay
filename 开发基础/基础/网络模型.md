### TCP/IP 网络模型

- **应用层**(Application Layer): 应用软件都是在应用层实现的,应用层把需要传输的数据传给传输层,应用层工作在操作系统中的用户态,其他层工作在内核态

- **传输层**(Transport Layer): 传输层有两个传输协和`UDP`和`TCP`

  - `UDP`(User Datagram Protocol): 用户数据报协议,只负责发送数据包,不保证数据是否抵达,优点是实时性相对更好,效率高.
  - `TCP`(Transmission Control Protocol):传输层控制协议,TCP比UDP多了许多特性,流量控制,超时重传,拥塞控制等,这些特性是为了数据可靠的传输给对方.传输层的数据包大小超过MSS(TCP最大报文段长度)时,会把数据包分块,有分块丢失时只需要重传这个分块,而不需要重传整个数据包. 在TCP协议中,每个分块被称为`TCP段`(TCP Segment)
  - 当设备作为接收方时,传输层要把数据包传给应用,但是同一时间内可能有多个应用接收数据包,因此使用`端口`(port)来区分不同的应用.由于传输层的报文中会携带端口,因此接收方能够识别报文是发给哪个应用的.

- **网络层**(Internet Layer): 实际场景中的网络环境错综复杂,设备间的数据要传给其他设备需要在各种各样的节点和线路进行选择,`传输层`的设计为了简单高效和专注,所以实际上的传输功能交给了网络层.

  - `IP协议`(Internet Protocol): IP协议将传输层的报文作为数据部分,再加上IP包头组装成IP报文,如果IP报文超过MTU(以太网中一般为1500字节)就会**再次进行分片**,得到一个即将发送到网络的IP报文

  - 网络层通过IP区分不同的备,但是只靠IP寻址并不靠普,因此将IP分成两种意义

    - `网络号`:负责标识该IP属于哪个子网
    - `主机号`:负责标识同一个子网下的不同主机

    配合`子网掩码`能够算出IP地址的网络号和主机号,先匹配到网络号才会匹配主机号

  - `IP协议`除了寻址能力,还提供`路由`能力.实际场景中的两台设别,并不一定处于一个网络环境中,中间可能还有许多其他网络设备(网关,路由器,交换机等),所以数据包到达一个网络节点后,就会通过算法决定下一步的走向,`IP协议`的寻址能力就是确定下一步的方向,路由能力就是根据方向选择路径

- **数据链路层**(Data Link Layer): 实际场景中的网络环境错综复杂,如果在不同的网络中需要传输数据,就需要一个同时在两个网络中的设备,如路由器,路由器可以通过路由表计算出下一个要去的IP地址

  - 但是路由器怎么确定IP是哪个设备呢?

  于是就有了`数据链路层`,它标识了网络中的设备,为网络提供链路级别传输的服务.每一台设备的网卡都有MAC地址,用来唯一标识设备,路由器计算出IP地址,再通过ARR协议找到该目标地址的MAC地址,这样就能知道这个IP是哪个设备的了

- **物理层**(Physical Layer): 当数据准备从设备发送到网络时,需要把数据包转换成电信号,让其在物理介质中传输,这一层就是`物理层`,它主要为数据链路层提供二进制传输的服务



五层网络模型:`应用层->传输层->网络层->数据链路层->物理层`

[下一部分HTTP](./HTTP.md)

